{"id":"Wmto","dependencies":[{"name":"/Users/wolfzer44/www/vutiliti/package.json","includedInParent":true,"mtime":1584040983114},{"name":"/Users/wolfzer44/www/vutiliti/node_modules/sequelize/package.json","includedInParent":true,"mtime":1583299135701},{"name":"../../promise","loc":{"line":11,"column":24},"parent":"/Users/wolfzer44/www/vutiliti/node_modules/sequelize/lib/dialects/mysql/query-interface.js","resolved":"/Users/wolfzer44/www/vutiliti/node_modules/sequelize/lib/promise.js"},{"name":"../../errors","loc":{"line":12,"column":32},"parent":"/Users/wolfzer44/www/vutiliti/node_modules/sequelize/lib/dialects/mysql/query-interface.js","resolved":"/Users/wolfzer44/www/vutiliti/node_modules/sequelize/lib/errors/index.js"}],"generated":{"js":"\"use strict\";var e=require(\"../../promise\"),r=require(\"../../errors\");function n(r,n,t,a){return a=a||{},r.sequelize.query(r.QueryGenerator.getForeignKeyQuery(n.tableName?n:{tableName:n,schema:r.sequelize.config.database},t),Object.assign({raw:!0},a)).then(function(t){var[o]=t;if(o.length&&\"PRIMARY\"!==o[0].constraint_name)return e.map(o,function(e){return r.sequelize.query(r.QueryGenerator.dropForeignKeyQuery(n,e.constraint_name),Object.assign({raw:!0},a))})}).then(function(){return r.sequelize.query(r.QueryGenerator.removeColumnQuery(n,t),Object.assign({raw:!0},a))})}function t(e,n,t,a){var o=e.QueryGenerator.showConstraintsQuery(n.tableName?n:{tableName:n,schema:e.sequelize.config.database},t);return e.sequelize.query(o,Object.assign({},a,{type:e.sequelize.QueryTypes.SHOWCONSTRAINTS})).then(function(o){var s,u=o[0];if(!u||!u.constraintType)throw new r.UnknownConstraintError({message:\"Constraint \".concat(t,\" on table \").concat(n,\" does not exist\"),constraint:t,table:n});return s=\"FOREIGN KEY\"===u.constraintType?e.QueryGenerator.dropForeignKeyQuery(n,t):e.QueryGenerator.removeIndexQuery(u.tableName,u.constraintName),e.sequelize.query(s,a)})}exports.removeConstraint=t,exports.removeColumn=n;"},"sourceMaps":{"js":{"mappings":[{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":11,"column":0},"generated":{"line":1,"column":13}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"Promise","original":{"line":11,"column":6},"generated":{"line":1,"column":17}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"require","original":{"line":11,"column":16},"generated":{"line":1,"column":19}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":11,"column":24},"generated":{"line":1,"column":27}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"sequelizeErrors","original":{"line":12,"column":6},"generated":{"line":1,"column":44}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"require","original":{"line":12,"column":24},"generated":{"line":1,"column":46}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":12,"column":32},"generated":{"line":1,"column":54}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":24,"column":0},"generated":{"line":1,"column":70}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"removeColumn","original":{"line":24,"column":9},"generated":{"line":1,"column":79}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":24,"column":22},"generated":{"line":1,"column":81}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":24,"column":26},"generated":{"line":1,"column":83}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"columnName","original":{"line":24,"column":37},"generated":{"line":1,"column":85}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"options","original":{"line":24,"column":49},"generated":{"line":1,"column":87}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":27,"column":9},"generated":{"line":1,"column":90}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"options","original":{"line":25,"column":2},"generated":{"line":1,"column":97}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"options","original":{"line":25,"column":12},"generated":{"line":1,"column":99}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":25,"column":23},"generated":{"line":1,"column":102}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":27,"column":9},"generated":{"line":1,"column":105}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"sequelize","original":{"line":27,"column":12},"generated":{"line":1,"column":107}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"query","original":{"line":27,"column":22},"generated":{"line":1,"column":117}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":28,"column":4},"generated":{"line":1,"column":123}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"QueryGenerator","original":{"line":28,"column":7},"generated":{"line":1,"column":125}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"getForeignKeyQuery","original":{"line":28,"column":22},"generated":{"line":1,"column":140}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":28,"column":41},"generated":{"line":1,"column":159}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":28,"column":51},"generated":{"line":1,"column":161}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":28,"column":63},"generated":{"line":1,"column":171}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":28,"column":75},"generated":{"line":1,"column":173}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":29,"column":6},"generated":{"line":1,"column":174}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":29,"column":6},"generated":{"line":1,"column":184}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"schema","original":{"line":30,"column":6},"generated":{"line":1,"column":186}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":30,"column":14},"generated":{"line":1,"column":193}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"sequelize","original":{"line":30,"column":17},"generated":{"line":1,"column":195}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"config","original":{"line":30,"column":27},"generated":{"line":1,"column":205}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"database","original":{"line":30,"column":34},"generated":{"line":1,"column":212}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"columnName","original":{"line":31,"column":7},"generated":{"line":1,"column":222}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"Object","original":{"line":32,"column":4},"generated":{"line":1,"column":225}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"assign","original":{"line":32,"column":11},"generated":{"line":1,"column":232}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":32,"column":18},"generated":{"line":1,"column":239}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"raw","original":{"line":32,"column":20},"generated":{"line":1,"column":240}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":32,"column":25},"generated":{"line":1,"column":245}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"options","original":{"line":32,"column":33},"generated":{"line":1,"column":248}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"then","original":{"line":34,"column":5},"generated":{"line":1,"column":252}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":34,"column":10},"generated":{"line":1,"column":257}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":34,"column":25},"generated":{"line":1,"column":266}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":34,"column":11},"generated":{"line":1,"column":269}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"results","original":{"line":34,"column":12},"generated":{"line":1,"column":273}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":34,"column":25},"generated":{"line":1,"column":276}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":36,"column":10},"generated":{"line":1,"column":278}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"results","original":{"line":36,"column":11},"generated":{"line":1,"column":281}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"length","original":{"line":36,"column":19},"generated":{"line":1,"column":283}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":36,"column":60},"generated":{"line":1,"column":291}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"results","original":{"line":36,"column":29},"generated":{"line":1,"column":303}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":36,"column":37},"generated":{"line":1,"column":305}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraint_name","original":{"line":36,"column":40},"generated":{"line":1,"column":308}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"Promise","original":{"line":40,"column":13},"generated":{"line":1,"column":324}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"Promise","original":{"line":40,"column":13},"generated":{"line":1,"column":331}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"map","original":{"line":40,"column":21},"generated":{"line":1,"column":333}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"results","original":{"line":40,"column":25},"generated":{"line":1,"column":337}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":40,"column":34},"generated":{"line":1,"column":339}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraint","original":{"line":40,"column":34},"generated":{"line":1,"column":348}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":40,"column":48},"generated":{"line":1,"column":351}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":40,"column":48},"generated":{"line":1,"column":358}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"sequelize","original":{"line":40,"column":51},"generated":{"line":1,"column":360}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"query","original":{"line":40,"column":61},"generated":{"line":1,"column":370}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":41,"column":8},"generated":{"line":1,"column":376}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"QueryGenerator","original":{"line":41,"column":11},"generated":{"line":1,"column":378}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"dropForeignKeyQuery","original":{"line":41,"column":26},"generated":{"line":1,"column":393}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":41,"column":46},"generated":{"line":1,"column":413}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraint","original":{"line":41,"column":57},"generated":{"line":1,"column":415}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraint_name","original":{"line":41,"column":68},"generated":{"line":1,"column":417}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"Object","original":{"line":42,"column":8},"generated":{"line":1,"column":434}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"assign","original":{"line":42,"column":15},"generated":{"line":1,"column":441}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":42,"column":22},"generated":{"line":1,"column":448}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"raw","original":{"line":42,"column":24},"generated":{"line":1,"column":449}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":42,"column":29},"generated":{"line":1,"column":454}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"options","original":{"line":42,"column":37},"generated":{"line":1,"column":457}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"then","original":{"line":45,"column":5},"generated":{"line":1,"column":465}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":45,"column":10},"generated":{"line":1,"column":470}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":45,"column":16},"generated":{"line":1,"column":481}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":45,"column":16},"generated":{"line":1,"column":488}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"sequelize","original":{"line":45,"column":19},"generated":{"line":1,"column":490}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"query","original":{"line":45,"column":29},"generated":{"line":1,"column":500}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":46,"column":6},"generated":{"line":1,"column":506}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"QueryGenerator","original":{"line":46,"column":9},"generated":{"line":1,"column":508}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"removeColumnQuery","original":{"line":46,"column":24},"generated":{"line":1,"column":523}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":46,"column":42},"generated":{"line":1,"column":541}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"columnName","original":{"line":46,"column":53},"generated":{"line":1,"column":543}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"Object","original":{"line":47,"column":6},"generated":{"line":1,"column":546}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"assign","original":{"line":47,"column":13},"generated":{"line":1,"column":553}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":47,"column":20},"generated":{"line":1,"column":560}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"raw","original":{"line":47,"column":22},"generated":{"line":1,"column":561}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":47,"column":27},"generated":{"line":1,"column":566}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"options","original":{"line":47,"column":35},"generated":{"line":1,"column":569}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":59,"column":0},"generated":{"line":1,"column":575}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"removeConstraint","original":{"line":59,"column":9},"generated":{"line":1,"column":584}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":59,"column":26},"generated":{"line":1,"column":586}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":59,"column":30},"generated":{"line":1,"column":588}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraintName","original":{"line":59,"column":41},"generated":{"line":1,"column":590}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"options","original":{"line":59,"column":57},"generated":{"line":1,"column":592}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"sql","original":{"line":60,"column":8},"generated":{"line":1,"column":595}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"sql","original":{"line":60,"column":8},"generated":{"line":1,"column":599}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":60,"column":14},"generated":{"line":1,"column":601}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"QueryGenerator","original":{"line":60,"column":17},"generated":{"line":1,"column":603}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"showConstraintsQuery","original":{"line":60,"column":32},"generated":{"line":1,"column":618}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":61,"column":4},"generated":{"line":1,"column":639}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":61,"column":14},"generated":{"line":1,"column":641}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":61,"column":26},"generated":{"line":1,"column":651}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":61,"column":38},"generated":{"line":1,"column":653}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":62,"column":6},"generated":{"line":1,"column":654}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":62,"column":6},"generated":{"line":1,"column":664}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"schema","original":{"line":63,"column":6},"generated":{"line":1,"column":666}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":63,"column":14},"generated":{"line":1,"column":673}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"sequelize","original":{"line":63,"column":17},"generated":{"line":1,"column":675}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"config","original":{"line":63,"column":27},"generated":{"line":1,"column":685}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"database","original":{"line":63,"column":34},"generated":{"line":1,"column":692}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraintName","original":{"line":64,"column":7},"generated":{"line":1,"column":702}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":66,"column":9},"generated":{"line":1,"column":705}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":66,"column":9},"generated":{"line":1,"column":712}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"sequelize","original":{"line":66,"column":12},"generated":{"line":1,"column":714}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"query","original":{"line":66,"column":22},"generated":{"line":1,"column":724}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"sql","original":{"line":66,"column":28},"generated":{"line":1,"column":730}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"Object","original":{"line":66,"column":33},"generated":{"line":1,"column":732}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"assign","original":{"line":66,"column":40},"generated":{"line":1,"column":739}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":66,"column":47},"generated":{"line":1,"column":746}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"options","original":{"line":66,"column":51},"generated":{"line":1,"column":749}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":67,"column":4},"generated":{"line":1,"column":751}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"type","original":{"line":67,"column":6},"generated":{"line":1,"column":752}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":67,"column":12},"generated":{"line":1,"column":757}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"sequelize","original":{"line":67,"column":15},"generated":{"line":1,"column":759}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"QueryTypes","original":{"line":67,"column":25},"generated":{"line":1,"column":769}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"SHOWCONSTRAINTS","original":{"line":67,"column":36},"generated":{"line":1,"column":780}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"then","original":{"line":68,"column":5},"generated":{"line":1,"column":799}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":68,"column":10},"generated":{"line":1,"column":804}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraints","original":{"line":68,"column":10},"generated":{"line":1,"column":813}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraint","original":{"line":69,"column":12},"generated":{"line":1,"column":816}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"query","original":{"line":70,"column":10},"generated":{"line":1,"column":820}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraint","original":{"line":69,"column":12},"generated":{"line":1,"column":822}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraints","original":{"line":69,"column":25},"generated":{"line":1,"column":824}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":69,"column":37},"generated":{"line":1,"column":826}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":71,"column":10},"generated":{"line":1,"column":829}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraint","original":{"line":71,"column":11},"generated":{"line":1,"column":833}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraint","original":{"line":71,"column":26},"generated":{"line":1,"column":837}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraintType","original":{"line":71,"column":37},"generated":{"line":1,"column":839}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":72,"column":14},"generated":{"line":1,"column":854}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":72,"column":14},"generated":{"line":1,"column":860}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"sequelizeErrors","original":{"line":72,"column":18},"generated":{"line":1,"column":864}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"UnknownConstraintError","original":{"line":72,"column":34},"generated":{"line":1,"column":866}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":73,"column":10},"generated":{"line":1,"column":889}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"message","original":{"line":74,"column":12},"generated":{"line":1,"column":890}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraintName","original":{"line":74,"column":35},"generated":{"line":1,"column":898}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraintName","original":{"line":74,"column":35},"generated":{"line":1,"column":912}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraintName","original":{"line":74,"column":35},"generated":{"line":1,"column":919}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":74,"column":62},"generated":{"line":1,"column":921}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":74,"column":62},"generated":{"line":1,"column":935}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":74,"column":62},"generated":{"line":1,"column":942}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":73,"column":10},"generated":{"line":1,"column":944}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraint","original":{"line":75,"column":12},"generated":{"line":1,"column":963}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraintName","original":{"line":75,"column":24},"generated":{"line":1,"column":974}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"table","original":{"line":76,"column":12},"generated":{"line":1,"column":976}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":76,"column":19},"generated":{"line":1,"column":982}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":86,"column":13},"generated":{"line":1,"column":986}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"query","original":{"line":81,"column":8},"generated":{"line":1,"column":993}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","original":{"line":80,"column":40},"generated":{"line":1,"column":995}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraint","original":{"line":80,"column":10},"generated":{"line":1,"column":1011}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraintType","original":{"line":80,"column":21},"generated":{"line":1,"column":1013}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":81,"column":16},"generated":{"line":1,"column":1028}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"QueryGenerator","original":{"line":81,"column":19},"generated":{"line":1,"column":1030}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"dropForeignKeyQuery","original":{"line":81,"column":34},"generated":{"line":1,"column":1045}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":81,"column":54},"generated":{"line":1,"column":1065}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraintName","original":{"line":81,"column":65},"generated":{"line":1,"column":1067}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":83,"column":16},"generated":{"line":1,"column":1070}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"QueryGenerator","original":{"line":83,"column":19},"generated":{"line":1,"column":1072}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"removeIndexQuery","original":{"line":83,"column":34},"generated":{"line":1,"column":1087}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraint","original":{"line":83,"column":51},"generated":{"line":1,"column":1104}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"tableName","original":{"line":83,"column":62},"generated":{"line":1,"column":1106}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraint","original":{"line":83,"column":73},"generated":{"line":1,"column":1116}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"constraintName","original":{"line":83,"column":84},"generated":{"line":1,"column":1118}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"qi","original":{"line":86,"column":13},"generated":{"line":1,"column":1134}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"sequelize","original":{"line":86,"column":16},"generated":{"line":1,"column":1136}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"query","original":{"line":86,"column":26},"generated":{"line":1,"column":1146}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"query","original":{"line":86,"column":32},"generated":{"line":1,"column":1152}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"options","original":{"line":86,"column":39},"generated":{"line":1,"column":1154}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"exports","original":{"line":90,"column":0},"generated":{"line":1,"column":1159}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"removeConstraint","original":{"line":90,"column":8},"generated":{"line":1,"column":1167}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"removeConstraint","original":{"line":90,"column":27},"generated":{"line":1,"column":1184}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"exports","original":{"line":91,"column":0},"generated":{"line":1,"column":1186}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"removeColumn","original":{"line":91,"column":8},"generated":{"line":1,"column":1194}},{"source":"../node_modules/sequelize/lib/dialects/mysql/query-interface.js","name":"removeColumn","original":{"line":91,"column":23},"generated":{"line":1,"column":1207}}],"sources":{"../node_modules/sequelize/lib/dialects/mysql/query-interface.js":"'use strict';\n\n/**\n Returns an object that treats MySQL's inabilities to do certain queries.\n\n @class QueryInterface\n @static\n @private\n */\n\nconst Promise = require('../../promise');\nconst sequelizeErrors = require('../../errors');\n\n/**\n A wrapper that fixes MySQL's inability to cleanly remove columns from existing tables if they have a foreign key constraint.\n\n @param  {QueryInterface} qi\n @param  {string} tableName     The name of the table.\n @param  {string} columnName    The name of the attribute that we want to remove.\n @param  {Object} options\n\n @private\n */\nfunction removeColumn(qi, tableName, columnName, options) {\n  options = options || {};\n\n  return qi.sequelize.query(\n    qi.QueryGenerator.getForeignKeyQuery(tableName.tableName ? tableName : {\n      tableName,\n      schema: qi.sequelize.config.database\n    }, columnName),\n    Object.assign({ raw: true }, options)\n  )\n    .then(([results]) => {\n      //Exclude primary key constraint\n      if (!results.length || results[0].constraint_name === 'PRIMARY') {\n        // No foreign key constraints found, so we can remove the column\n        return;\n      }\n      return Promise.map(results, constraint => qi.sequelize.query(\n        qi.QueryGenerator.dropForeignKeyQuery(tableName, constraint.constraint_name),\n        Object.assign({ raw: true }, options)\n      ));\n    })\n    .then(() => qi.sequelize.query(\n      qi.QueryGenerator.removeColumnQuery(tableName, columnName),\n      Object.assign({ raw: true }, options)\n    ));\n}\n\n/**\n * @param {QueryInterface} qi\n * @param {string} tableName\n * @param {string} constraintName\n * @param {Object} options\n *\n * @private\n */\nfunction removeConstraint(qi, tableName, constraintName, options) {\n  const sql = qi.QueryGenerator.showConstraintsQuery(\n    tableName.tableName ? tableName : {\n      tableName,\n      schema: qi.sequelize.config.database\n    }, constraintName);\n\n  return qi.sequelize.query(sql, Object.assign({}, options,\n    { type: qi.sequelize.QueryTypes.SHOWCONSTRAINTS }))\n    .then(constraints => {\n      const constraint = constraints[0];\n      let query;\n      if (!constraint || !constraint.constraintType) {\n        throw new sequelizeErrors.UnknownConstraintError(\n          {\n            message: `Constraint ${constraintName} on table ${tableName} does not exist`,\n            constraint: constraintName,\n            table: tableName\n          });\n      }\n\n      if (constraint.constraintType === 'FOREIGN KEY') {\n        query = qi.QueryGenerator.dropForeignKeyQuery(tableName, constraintName);\n      } else {\n        query = qi.QueryGenerator.removeIndexQuery(constraint.tableName, constraint.constraintName);\n      }\n\n      return qi.sequelize.query(query, options);\n    });\n}\n\nexports.removeConstraint = removeConstraint;\nexports.removeColumn = removeColumn;\n"},"lineCount":null}},"error":null,"hash":"5b96db4c582e4e718ab99344faf00dd7","cacheData":{"env":{}}}